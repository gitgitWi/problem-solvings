// @ts-check

/**
 * BOJ. 2178. 미로탐색
 * @see https://www.acmicpc.net/problem/2178
 *
 * @param input {string[]}
 * @returns  {number}
 */
const solution = (input) => {
  const [nm, ...miros] = input;
  const [n, m] = nm.split(" ").map(Number);
  const miroArray = miros.map((row) => row.split("").map(Number));

  const visited = miroArray.map((row) => row.map((_) => 0));
  visited[0][0] = 1;

  const dx = [-1, 0, 1, 0];
  const dy = [0, 1, 0, -1];

  /**
   * @type {[number, number][]}
   */
  const queue = [[0, 0]];

  while (queue.length > 0) {
    const [cy, cx] = queue.shift();

    for (let i = 0; i < 4; i++) {
      const [nextY, nextX] = [cy + dy[i], cx + dx[i]];
      if (!canMove(nextY, nextX, n, m, miroArray) || visited[nextY][nextX])
        continue;
      visited[nextY][nextX] = visited[cy][cx] + 1;
      queue.push([nextY, nextX]);
    }
  }

  return visited[n - 1][m - 1];
};

/**
 * @param {number} rowIdx
 * @param {number} colIdx
 * @param {number} n
 * @param {number} m
 * @param {number[][]} arr
 * @returns {boolean}
 */
const canMove = (rowIdx, colIdx, n, m, arr) => {
  if (rowIdx < 0 || colIdx < 0) return false;
  if (rowIdx >= n || colIdx >= m) return false;
  if (arr[rowIdx][colIdx] === 0) return false;
  return true;
};

const main = () => {
  // const input = require("fs")
  //   .readFileSync("/dev/stdin")
  //   .toString()
  //   .trim()
  //   .split("\n");
  // console.log(solution(input));

  [
    ["4 6", "101111", "101010", "101011", "111011"],
    ["4 6", "110110", "110110", "111111", "111101"],
    ["2 25", "1011101110111011101110111", "1110111011101110111011101"],
    [
      "7 7",
      "1011111",
      "1110001",
      "1000001",
      "1000001",
      "1000001",
      "1000001",
      "1111111",
    ],
    [
      "100 100",
      "1111111111111111111111111111111111111111111111111101111111111111111111111111111111111111111111111111",
      "0000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111100101010011111101011111100101010011111110101111111001010100111111010111111001010100111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111100110101010110011101011100110101010110011110101111001101010101100111010111001101010101100111111",
      "1110111110101010111110101010111110101010111110110101101111101010101111101010101111101010101111101111",
      "1110100000101010000010101010100000101010000010110101101000001010100000101010101000001010100000101111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "0000000000111110000000001000000000111110000000000100000000001111100000000010000000001111100000000000",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1110100000101010000010101010100000101010000010110101101000001010100000101010101000001010100000101111",
      "1110111110101010111110101010111110101010111110110101101111101010101111101010101111101010101111101111",
      "1111100110101010110011101011100110101010110011110101111001101010101100111010111001101010101100111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111100101010011111101011111100101010011111110101111111001010100111111010111111001010100111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "0000000000001000000000001000000000001000000000000100000000000010000000000010000000000010000000000000",
      "1111111111101111111111101011111111111011111111110101111111111011111111111010111111111110111111111111",
      "0000000000000000000000111110000000000000000000000100000000000000000000001111100000000000000000000000",
      "1111111111101111111111101011111111111011111111110101111111111011111111111010111111111110111111111111",
      "0000000000001000000000001000000000001000000000000100000000000010000000000010000000000010000000000000",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111100101010011111101011111100101010011111110101111111001010100111111010111111001010100111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111100110101010110011101011100110101010110011110101111001101010101100111010111001101010101100111111",
      "1110111110101010111110101010111110101010111110110101101111101010101111101010101111101010101111101111",
      "1110100000101010000010101010100000101010000010110101101000001010100000101010101000001010100000101111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "0000000000111110000000001000000000111110000000000100000000001111100000000010000000001111100000000000",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1110100000101010000010101010100000101010000010110101101000001010100000101010101000001010100000101111",
      "1110111110101010111110101010111110101010111110110101101111101010101111101010101111101010101111101111",
      "1111100110101010110011101011100110101010110011110101111001101010101100111010111001101010101100111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111100101010011111101011111100101010011111110101111111001010100111111010111111001010100111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "0000000000000000000000001000000000000000000000000100000000000000000000000010000000000000000000000000",
      "1111111111111111111111101111111111111111111111110101111111111111111111111110111111111111111111111111",
      "0000000000000000000000000000000000000000000000011111000000000000000000000000000000000000000000000000",
      "1111111111111111111111101111111111111111111111110101111111111111111111111110111111111111111111111111",
      "0000000000000000000000001000000000000000000000000100000000000000000000000010000000000000000000000000",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111100101010011111101011111100101010011111110101111111001010100111111010111111001010100111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111100110101010110011101011100110101010110011110101111001101010101100111010111001101010101100111111",
      "1110111110101010111110101010111110101010111110110101101111101010101111101010101111101010101111101111",
      "1110100000101010000010101010100000101010000010110101101000001010100000101010101000001010100000101111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "0000000000111110000000001000000000111110000000000100000000001111100000000010000000001111100000000000",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1110100000101010000010101010100000101010000010110101101000001010100000101010101000001010100000101111",
      "1110111110101010111110101010111110101010111110110101101111101010101111101010101111101010101111101111",
      "1111100110101010110011101011100110101010110011110101111001101010101100111010111001101010101100111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111100101010011111101011111100101010011111110101111111001010100111111010111111001010100111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "0000000000001000000000001000000000001000000000000100000000000010000000000010000000000010000000000000",
      "1111111111101111111111101011111111111011111111110101111111111011111111111010111111111110111111111111",
      "0000000000000000000000111110000000000000000000000100000000000000000000001111100000000000000000000000",
      "1111111111101111111111101011111111111011111111110101111111111011111111111010111111111110111111111111",
      "0000000000001000000000001000000000001000000000000100000000000010000000000010000000000010000000000000",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111100101010011111101011111100101010011111110101111111001010100111111010111111001010100111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111100110101010110011101011100110101010110011110101111001101010101100111010111001101010101100111111",
      "1110111110101010111110101010111110101010111110110101101111101010101111101010101111101010101111101111",
      "1110100000101010000010101010100000101010000010110101101000001010100000101010101000001010100000101111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "0000000000111110000000001000000000111110000000000100000000001111100000000010000000001111100000000000",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1110100000101010000010101010100000101010000010110101101000001010100000101010101000001010100000101111",
      "1110111110101010111110101010111110101010111110110101101111101010101111101010101111101010101111101111",
      "1111100110101010110011101011100110101010110011110101111001101010101100111010111001101010101100111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111010101010101111101011111010101010101111110101111110101010101011111010111110101010101011111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111100101010011111101011111100101010011111110101111111001010100111111010111111001010100111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
      "1111111111101011111111101011111111101011111111110101111111111010111111111010111111111010111111111111",
    ],
    [
      "100 100",
      "1111111111111111111111111111111111111111111111111101111111111111111111111111111111111111111111111111",
      "0000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111000000101010000001111111111111110101111111111111110000001010100000011111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111000010101010100001111111111111110101111111111111110000101010101000011111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010000001111110101010111111000000101111110101111110100000011111101010101111110000001011111111",
      "1111111011111111111110101010111111111111101111110101111110111111111111101010101111111111111011111111",
      "1100000010000000000000101010000000000000100000010101000000100000000000001010100000000000001000000111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "0000000000000000000000111110000000000000000000000100000000000000000000001111100000000000000000000000",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1100000010000000000000101010000000000000100000010101000000100000000000001010100000000000001000000111",
      "1111111011111111111110101010111111111111101111110101111110111111111111101010101111111111111011111111",
      "1111111010000001111110101010111111000000101111110101111110100000011111101010101111110000001011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111000010101010100001111111111111110101111111111111110000101010101000011111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111000000101010000001111111111111110101111111111111110000001010100000011111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "0000000000000000000000001000000000000000000000000100000000000000000000000010000000000000000000000000",
      "1111111111111111111111101111111111111111111111110101111111111111111111111110111111111111111111111111",
      "0000000000000000000000000000000000000000000000011111000000000000000000000000000000000000000000000000",
      "1111111111111111111111101111111111111111111111110101111111111111111111111110111111111111111111111111",
      "0000000000000000000000001000000000000000000000000100000000000000000000000010000000000000000000000000",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111000000101010000001111111111111110101111111111111110000001010100000011111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111000010101010100001111111111111110101111111111111110000101010101000011111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010000001111110101010111111000000101111110101111110100000011111101010101111110000001011111111",
      "1111111011111111111110101010111111111111101111110101111110111111111111101010101111111111111011111111",
      "1100000010000000000000101010000000000000100000010101000000100000000000001010100000000000001000000111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "0000000000000000000000111110000000000000000000000100000000000000000000001111100000000000000000000000",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1100000010000000000000101010000000000000100000010101000000100000000000001010100000000000001000000111",
      "1111111011111111111110101010111111111111101111110101111110111111111111101010101111111111111011111111",
      "1111111010000001111110101010111111000000101111110101111110100000011111101010101111110000001011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111010111111111110101010111111111110101111110101111110101111111111101010101111111111101011111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111111010101010101111111111111111110101111111111111111110101010101011111111111111111111",
      "1111111111111111000010101010100001111111111111110101111111111111110000101010101000011111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111000000101010000001111111111111110101111111111111110000001010100000011111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111110101010111111111111111111110101111111111111111111101010101111111111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
      "1111111111111111111111101011111111111111111111110101111111111111111111111010111111111111111111111111",
    ],
  ].forEach((q) => {
    const timeKey = q[0];
    console.time(timeKey);
    console.log(solution(q));
    console.timeEnd(timeKey);
  });
};

main();
